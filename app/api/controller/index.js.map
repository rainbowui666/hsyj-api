{
    "version": 3,
    "sources": [
        "../../../src/api/controller/index.js"
    ],
    "names": [
        "Base",
        "require",
        "module",
        "exports",
        "indexAction",
        "User",
        "model",
        "select",
        "success",
        "homeAction",
        "_pk",
        "data",
        "field",
        "where",
        "isrecommend",
        "shstate",
        "order",
        "limit",
        "arrdata",
        "item",
        "pics",
        "getPicsbyid",
        "activityID",
        "joinnum",
        "getJoinNum",
        "push",
        "model2",
        "data2",
        "arrdata2",
        "sceneryID",
        "alldata",
        "activitydata",
        "scenerydata",
        "getIndexDataAction"
    ],
    "mappings": ";;AAAA,MAAMA,OAAOC,QAAQ,WAAR,CAAb;;AAEAC,OAAOC,OAAP,GAAiB,cAAcH,IAAd,CAAmB;AAC5BI,aAAN,GAAoB;AAAA;;AAAA;AAClB,YAAMC,OAAO,MAAM,MAAKC,KAAL,CAAW,MAAX,EAAmBC,MAAnB,EAAnB;;AAEF;AACA;AACE,aAAO,MAAKC,OAAL,CAAa;AAClBH,cAAMA;AADY,OAAb,CAAP;AALkB;AAQnB;;AAEKI,YAAN,GAAmB;AAAA;;AAAA;;AAEjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAMH,QAAQ,OAAKA,KAAL,CAAW,UAAX,CAAd;AACAA,YAAMI,GAAN,GAAY,YAAZ;AACA,YAAMC,OAAO,MAAML,MAAMM,KAAN,CAAY,CAAC,YAAD,EAAe,cAAf,CAAZ,EAA4CC,KAA5C,CAAkD,EAACC,aAAY,CAAb,EAAgBC,SAAQ,CAAxB,EAAlD,EAA8EC,KAA9E,CAAoF,iBAApF,EAAuGC,KAAvG,CAA6G,CAA7G,EAA+G,CAA/G,EAAkHV,MAAlH,EAAnB;;AAEA,YAAMW,UAAU,EAAhB;AACA,WAAK,MAAMC,IAAX,IAAmBR,IAAnB,EAAyB;AACvBQ,aAAKC,IAAL,GAAY,MAAM,OAAKd,KAAL,CAAW,UAAX,EAAuBe,WAAvB,CAAmCF,KAAKG,UAAxC,CAAlB;AACAH,aAAKI,OAAL,GAAe,MAAM,OAAKjB,KAAL,CAAW,kBAAX,EAA+BkB,UAA/B,CAA0CL,KAAKG,UAA/C,CAArB;AACAJ,gBAAQO,IAAR,CAAaN,IAAb;AACD;;AAED;AACA,YAAMO,SAAS,OAAKpB,KAAL,CAAW,SAAX,CAAf;AACAoB,aAAOhB,GAAP,GAAa,WAAb;AACA,YAAMiB,QAAQ,MAAMD,OAAOd,KAAP,CAAa,CAAC,WAAD,EAAc,cAAd,CAAb,EAA4CC,KAA5C,CAAkD,EAACC,aAAY,CAAb,EAAgBC,SAAQ,CAAxB,EAAlD,EAA8EC,KAA9E,CAAoF,gBAApF,EAAsGC,KAAtG,CAA4G,CAA5G,EAA8G,CAA9G,EAAiHV,MAAjH,EAApB;;AAEA,YAAMqB,WAAW,EAAjB;AACA,WAAK,MAAMT,IAAX,IAAmBQ,KAAnB,EAA0B;AACxBR,aAAKC,IAAL,GAAY,MAAM,OAAKd,KAAL,CAAW,SAAX,EAAsBe,WAAtB,CAAkCF,KAAKU,SAAvC,CAAlB;AACAV,aAAKI,OAAL,GAAe,MAAM,OAAKjB,KAAL,CAAW,iBAAX,EAA8BkB,UAA9B,CAAyCL,KAAKU,SAA9C,CAArB;AACAD,iBAASH,IAAT,CAAcN,IAAd;AACD;;AAED;AACA,UAAIW,UAAU,EAACC,cAAcb,OAAf,EAAwBc,aAAaJ;AACnD;AADc,OAAd,CAEA,OAAO,OAAKpB,OAAL,CAAasB,OAAb,CAAP;AApCiB;AAqClB;;AAEKG,oBAAN,GAA0B;AACxB;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAZwB;AAazB;AA/DiC,CAApC",
    "file": "../../../src/api/controller/index.js",
    "sourcesContent": [
        "const Base = require('./base.js');\n\nmodule.exports = class extends Base {\n  async indexAction() {\n    const User = await this.model('User').select();\n\n  // const data = await this.cache('rds_user');\n  // console.log(data)\n    return this.success({\n      User: User\n    });\n  }\n\n  async homeAction() {\n\n    // await this.cache('home_activity_scenery', null)\n    // await this.cache('home_activity_scenery', null, 'redis')\n    // const homedata = await this.cache('home_activity_scenery');\n    // if (!think.isEmpty(homedata)) {\n    //   console.log('redis found data ...')\n    //   return this.success(homedata)\n    // }\n    // 活动推荐\n    const model = this.model('activity');\n    model._pk = 'activityID';\n    const data = await model.field(['activityID', 'activityName']).where({isrecommend:1, shstate:0}).order('activityID desc').limit(0,5).select();\n    \n    const arrdata = [];\n    for (const item of data) {\n      item.pics = await this.model('activity').getPicsbyid(item.activityID);\n      item.joinnum = await this.model('student_activity').getJoinNum(item.activityID);\n      arrdata.push(item);\n    }\n\n    // 景点推荐\n    const model2 = this.model('scenery');\n    model2._pk = 'sceneryID';\n    const data2 = await model2.field(['sceneryID', 'sceneryTitle']).where({isrecommend:1, shstate:0}).order('sceneryID desc').limit(0,5).select();\n    \n    const arrdata2 = [];\n    for (const item of data2) {\n      item.pics = await this.model('scenery').getPicsbyid(item.sceneryID);\n      item.joinnum = await this.model('student_scenery').getJoinNum(item.sceneryID);\n      arrdata2.push(item);\n    }\n\n    // console.log('write...')\n    let alldata = {activitydata: arrdata, scenerydata: arrdata2}\n    // await this.cache('home_activity_scenery', alldata, 'redis')\n    return this.success(alldata)\n  }\n\n  async getIndexDataAction(){\n    // let rdsoption = {auth_pass:'000000'}\n\n    // var client = redis.createClient(6379,'127.0.0.1', rdsoption);\n\n    // client.auth('000000',function(){\n    //   console.log('pass......')\n    // })\n    // client.set('hello',\"{aa:'bb',dd:'1234'}\");\n\n    // client.get('hello',function (err,v) {\n    //     console.log(\"redis get hello err,v\",err,v);\n    // })\n  }\n};\n"
    ]
}
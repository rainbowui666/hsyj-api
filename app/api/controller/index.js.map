{
    "version": 3,
    "sources": [
        "../../../src/api/controller/index.js"
    ],
    "names": [
        "Base",
        "require",
        "module",
        "exports",
        "indexAction",
        "User",
        "model",
        "select",
        "success",
        "homeAction",
        "homedata",
        "cache",
        "think",
        "isEmpty",
        "console",
        "log",
        "_pk",
        "data",
        "field",
        "where",
        "isrecommend",
        "order",
        "limit",
        "arrdata",
        "item",
        "pics",
        "getPicsbyid",
        "activityID",
        "joinnum",
        "getJoinNum",
        "push",
        "model2",
        "data2",
        "arrdata2",
        "sceneryID",
        "alldata",
        "activitydata",
        "scenerydata",
        "getIndexDataAction"
    ],
    "mappings": ";;AAAA,MAAMA,OAAOC,QAAQ,WAAR,CAAb;;AAEAC,OAAOC,OAAP,GAAiB,cAAcH,IAAd,CAAmB;AAC5BI,aAAN,GAAoB;AAAA;;AAAA;AAClB,YAAMC,OAAO,MAAM,MAAKC,KAAL,CAAW,MAAX,EAAmBC,MAAnB,EAAnB;;AAEF;AACA;AACE,aAAO,MAAKC,OAAL,CAAa;AAClBH,cAAMA;AADY,OAAb,CAAP;AALkB;AAQnB;;AAEKI,YAAN,GAAmB;AAAA;;AAAA;;AAEjB;AACA;AACA,YAAMC,WAAW,MAAM,OAAKC,KAAL,CAAW,uBAAX,CAAvB;AACA,UAAI,CAACC,MAAMC,OAAN,CAAcH,QAAd,CAAL,EAA8B;AAC5BI,gBAAQC,GAAR,CAAY,sBAAZ;AACA,eAAO,OAAKP,OAAL,CAAaE,QAAb,CAAP;AACD;AACD;AACA,YAAMJ,QAAQ,OAAKA,KAAL,CAAW,UAAX,CAAd;AACAA,YAAMU,GAAN,GAAY,YAAZ;AACA,YAAMC,OAAO,MAAMX,MAAMY,KAAN,CAAY,CAAC,YAAD,EAAe,cAAf,CAAZ,EAA4CC,KAA5C,CAAkD,EAACC,aAAY,CAAb,EAAlD,EAAmEC,KAAnE,CAAyE,iBAAzE,EAA4FC,KAA5F,CAAkG,CAAlG,EAAoG,CAApG,EAAuGf,MAAvG,EAAnB;;AAEA,YAAMgB,UAAU,EAAhB;AACA,WAAK,MAAMC,IAAX,IAAmBP,IAAnB,EAAyB;AACvBO,aAAKC,IAAL,GAAY,MAAM,OAAKnB,KAAL,CAAW,UAAX,EAAuBoB,WAAvB,CAAmCF,KAAKG,UAAxC,CAAlB;AACAH,aAAKI,OAAL,GAAe,MAAM,OAAKtB,KAAL,CAAW,kBAAX,EAA+BuB,UAA/B,CAA0CL,KAAKG,UAA/C,CAArB;AACAJ,gBAAQO,IAAR,CAAaN,IAAb;AACD;;AAED;AACA,YAAMO,SAAS,OAAKzB,KAAL,CAAW,SAAX,CAAf;AACAyB,aAAOf,GAAP,GAAa,WAAb;AACA,YAAMgB,QAAQ,MAAMD,OAAOb,KAAP,CAAa,CAAC,WAAD,EAAc,cAAd,CAAb,EAA4CC,KAA5C,CAAkD,EAACC,aAAY,CAAb,EAAlD,EAAmEC,KAAnE,CAAyE,gBAAzE,EAA2FC,KAA3F,CAAiG,CAAjG,EAAmG,CAAnG,EAAsGf,MAAtG,EAApB;;AAEA,YAAM0B,WAAW,EAAjB;AACA,WAAK,MAAMT,IAAX,IAAmBQ,KAAnB,EAA0B;AACxBR,aAAKC,IAAL,GAAY,MAAM,OAAKnB,KAAL,CAAW,SAAX,EAAsBoB,WAAtB,CAAkCF,KAAKU,SAAvC,CAAlB;AACAV,aAAKI,OAAL,GAAe,MAAM,OAAKtB,KAAL,CAAW,iBAAX,EAA8BuB,UAA9B,CAAyCL,KAAKU,SAA9C,CAArB;AACAD,iBAASH,IAAT,CAAcN,IAAd;AACD;;AAEDV,cAAQC,GAAR,CAAY,UAAZ;AACA,UAAIoB,UAAU,EAACC,cAAcb,OAAf,EAAwBc,aAAaJ,QAArC,EAAd;AACA,YAAM,OAAKtB,KAAL,CAAW,uBAAX,EAAoCwB,OAApC,EAA6C,OAA7C,CAAN;AACA,aAAO,OAAK3B,OAAL,CAAa2B,OAAb,CAAP;AApCiB;AAqClB;;AAEKG,oBAAN,GAA0B;AACxB;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAZwB;AAazB;AA/DiC,CAApC",
    "file": "../../../src/api/controller/index.js",
    "sourcesContent": [
        "const Base = require('./base.js');\n\nmodule.exports = class extends Base {\n  async indexAction() {\n    const User = await this.model('User').select();\n\n  // const data = await this.cache('rds_user');\n  // console.log(data)\n    return this.success({\n      User: User\n    });\n  }\n\n  async homeAction() {\n\n    // await this.cache('home_activity_scenery', null)\n    // await this.cache('home_activity_scenery', null, 'redis')\n    const homedata = await this.cache('home_activity_scenery');\n    if (!think.isEmpty(homedata)) {\n      console.log('redis found data ...')\n      return this.success(homedata)\n    }\n    // 活动推荐\n    const model = this.model('activity');\n    model._pk = 'activityID';\n    const data = await model.field(['activityID', 'activityName']).where({isrecommend:1}).order('activityID desc').limit(0,5).select();\n    \n    const arrdata = [];\n    for (const item of data) {\n      item.pics = await this.model('activity').getPicsbyid(item.activityID);\n      item.joinnum = await this.model('student_activity').getJoinNum(item.activityID);\n      arrdata.push(item);\n    }\n\n    // 景点推荐\n    const model2 = this.model('scenery');\n    model2._pk = 'sceneryID';\n    const data2 = await model2.field(['sceneryID', 'sceneryTitle']).where({isrecommend:1}).order('sceneryID desc').limit(0,5).select();\n    \n    const arrdata2 = [];\n    for (const item of data2) {\n      item.pics = await this.model('scenery').getPicsbyid(item.sceneryID);\n      item.joinnum = await this.model('student_scenery').getJoinNum(item.sceneryID);\n      arrdata2.push(item);\n    }\n\n    console.log('write...')\n    let alldata = {activitydata: arrdata, scenerydata: arrdata2}\n    await this.cache('home_activity_scenery', alldata, 'redis')\n    return this.success(alldata)\n  }\n\n  async getIndexDataAction(){\n    // let rdsoption = {auth_pass:'000000'}\n\n    // var client = redis.createClient(6379,'127.0.0.1', rdsoption);\n\n    // client.auth('000000',function(){\n    //   console.log('pass......')\n    // })\n    // client.set('hello',\"{aa:'bb',dd:'1234'}\");\n\n    // client.get('hello',function (err,v) {\n    //     console.log(\"redis get hello err,v\",err,v);\n    // })\n  }\n};\n"
    ]
}
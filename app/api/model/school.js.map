{
    "version": 3,
    "sources": [
        "../../../src/api/model/school.js"
    ],
    "names": [
        "_",
        "require",
        "module",
        "exports",
        "think",
        "Model",
        "getPicsbyid",
        "id",
        "data",
        "model",
        "where",
        "sourceType",
        "targetid",
        "select",
        "getScenerybyid",
        "_pk",
        "schoolid",
        "arrdata",
        "item",
        "pics",
        "shstate",
        "getscenerystate",
        "sceneryID",
        "push",
        "getSchoolNameByIds",
        "ids",
        "str",
        "isEmpty",
        "arr",
        "split",
        "i",
        "length",
        "name",
        "field",
        "schoolID",
        "find",
        "schoolName",
        "substr",
        "getstate",
        "wantto",
        "count",
        "modeldis",
        "disnum",
        "distype",
        "sceneryid"
    ],
    "mappings": "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",
    "file": "../../../src/api/model/school.js",
    "sourcesContent": [
        "const _ = require('lodash');\n\nmodule.exports = class extends think.Model {\n    async getPicsbyid(id) {\n        const data = await this.model('source').where({sourceType: 0, targetid: id}).select();\n        return data;\n    }\n\n    async getScenerybyid(id) {\n        const model = this.model('scenery');\n        model._pk = 'sceneryID';\n        const data = await model.where({schoolid: id}).select();\n\n        const arrdata = [];\n        for (const item of data) {\n            // item.pics = item\n            item.pics = await this.getPicsbyid(item.schoolid);\n            item.shstate = await this.getscenerystate(item.sceneryID);\n            arrdata.push(item);\n        }\n        data.data = arrdata;\n        return data;\n    }\n\n    async getSchoolNameByIds(ids) {\n        let str = '';\n        if (think.isEmpty(ids)) return '';\n        let arr = ids.split(',');\n        for (let i = 0; i < arr.length; i++) {\n            let name = await this.model('school').field(['schoolName']).where({schoolID:arr[i]}).find();\n            str += name.schoolName +','\n        }\n        if (str && str.length > 0) {\n            str = str.substr(0, str.length -1);\n        }\n        return str;\n    }\n\n    async getstate(id) {\n        const model = this.model('student_school');\n        model._pk = 'schoolid';\n        // const checkin = await model.where({schoolid: id, shstate: 1}).count('schoolid');\n        const wantto = await model.where({schoolid: id, shstate: 0}).count('schoolid');\n        // const sharenum = await model.where({schoolid: id, shstate: 4}).count('schoolid');\n\n        const modeldis = this.model('discuss');\n        modeldis._pk = 'discussID';\n        const disnum = await modeldis.where({distype: 2, targetid: id, shstate: 1}).count('discussID');\n        return {\n            // checkin: checkin,\n            wantto: wantto,\n            // sharenum: sharenum,\n            disnum: disnum\n        }\n    }\n\n    async getscenerystate(id) {\n        const model = this.model('student_scenery');\n        model._pk = 'sceneryid';\n        // const checkin = await model.where({schoolid: id, shstate: 1}).count('schoolid');\n        const wantto = await model.where({sceneryid: id, shstate: 0}).count('sceneryid');\n        // const sharenum = await model.where({schoolid: id, shstate: 4}).count('schoolid');\n\n        const modeldis = this.model('discuss');\n        modeldis._pk = 'discussID';\n        const disnum = await modeldis.where({distype: 0, targetid: id, shstate: 1}).count('discussID');\n        return {\n            // checkin: checkin,\n            wantto: wantto,\n            // sharenum: sharenum,\n            disnum: disnum\n        }\n    }\n}"
    ]
}